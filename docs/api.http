### Benicio Advogados API - HTTP Test File
### Base URL: http://localhost:3333
### This file contains examples for testing all API endpoints
###
### Authentication: Most endpoints require JWT Bearer token
### Include header: Authorization: Bearer <token>
###
### API Conventions:
### - Content-Type: application/json (except file uploads)
### - Timestamps: ISO 8601 format
### - Database fields: snake_case naming
### - Pagination: ?page=1&limit=20
### - Sorting: ?sortBy=field&order=asc|desc
### - Search: ?search=term

### Variables (replace with actual values after login)
@baseUrl = http://localhost:3333/api/v1
@contentType = application/json

### Update these after successful login
@accessToken = eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...
@refreshToken = refresh_token_here
@userId = 1
@roleId = 1
@clientId = 1
@folderId = 1

################################################################################
# AUTHENTICATION
################################################################################

### Login - Get Access Token (Email)
# @name loginResponse
POST {{baseUrl}}/sessions/sign-in
Content-Type: {{contentType}}

{
  "uid": "employee@benicio.com.br",
  "password": "benicio123"
}

### Login with Username
POST {{baseUrl}}/sessions/sign-in
Content-Type: {{contentType}}

{
  "uid": "employee",
  "password": "benicio123"
}

### Login Admin
POST {{baseUrl}}/sessions/sign-in
Content-Type: {{contentType}}

{
  "uid": "admin@benicio.com.br",
  "password": "benicio123"
}

### Refresh Token
POST {{baseUrl}}/sessions/refresh
Content-Type: {{contentType}}

{
  "refresh_token": "{{refreshToken}}"
}

### Logout
POST {{baseUrl}}/sessions/sign-out
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

### Get Current User
GET {{baseUrl}}/sessions/me
Authorization: Bearer {{accessToken}}

### Register New User
POST {{baseUrl}}/sessions/sign-up
Content-Type: {{contentType}}

{
  "full_name": "João Silva",
  "email": "joao.silva@benicio.com.br",
  "username": "joaosilva",
  "password": "senha123",
  "password_confirmation": "senha123"
}

################################################################################
# FOLDERS (Cases/Processes)
################################################################################

### List All Folders (Paginated)
GET {{baseUrl}}/folders?page=1&per_page=20
Authorization: Bearer {{accessToken}}

### List Folders with Filters
GET {{baseUrl}}/folders?status=active&priority=high&page=1&per_page=10
Authorization: Bearer {{accessToken}}

### Search Folders
GET {{baseUrl}}/folders?search=Cobrança&page=1&per_page=20
Authorization: Bearer {{accessToken}}

### Filter by Client
GET {{baseUrl}}/folders?client_id=1&page=1&per_page=20
Authorization: Bearer {{accessToken}}

### Filter by Court
GET {{baseUrl}}/folders?court_id=1&page=1&per_page=20
Authorization: Bearer {{accessToken}}

### Filter by Folder Type
GET {{baseUrl}}/folders?folder_type_id=1&page=1&per_page=20
Authorization: Bearer {{accessToken}}

### Sort Folders
GET {{baseUrl}}/folders?sort_by=created_at&sort_order=desc&page=1&per_page=20
Authorization: Bearer {{accessToken}}

### Combined Filters
GET {{baseUrl}}/folders?status=active&client_id=1&folder_type_id=1&sort_by=case_value&sort_order=desc
Authorization: Bearer {{accessToken}}

### Get Folder Statistics
GET {{baseUrl}}/folders/stats
Authorization: Bearer {{accessToken}}

### Get Favorite Folders
GET {{baseUrl}}/folders/favorites?page=1&per_page=20
Authorization: Bearer {{accessToken}}

### Get Single Folder with Relationships
GET {{baseUrl}}/folders/{{folderId}}
Authorization: Bearer {{accessToken}}

### Create New Folder
POST {{baseUrl}}/folders
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
  "title": "Processo de Cobrança - Cliente XYZ",
  "description": "Ação de cobrança de valores devidos",
  "cnj_number": "0000001-23.2024.8.26.0100",
  "internal_client_code": "CLI-2024-001",
  "folder_type_id": 1,
  "client_id": 1,
  "court_id": 1,
  "responsible_lawyer_id": 2,
  "status": "active",
  "priority": "high",
  "case_value": 150000.00,
  "action_type": "Ação de Cobrança",
  "distribution_date": "2024-03-15",
  "distribution_type": "Sorteio"
}

### Update Folder
PUT {{baseUrl}}/folders/{{folderId}}
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
  "title": "Processo de Cobrança - Atualizado",
  "description": "Descrição atualizada do processo",
  "status": "pending",
  "priority": "medium",
  "case_value": 175000.00
}

### Toggle Favorite
PATCH {{baseUrl}}/folders/{{folderId}}/favorite
Authorization: Bearer {{accessToken}}

### Soft Delete Folder
DELETE {{baseUrl}}/folders/{{folderId}}
Authorization: Bearer {{accessToken}}

### Restore Deleted Folder
POST {{baseUrl}}/folders/{{folderId}}/restore
Authorization: Bearer {{accessToken}}

################################################################################
# CLIENTS
################################################################################

### List All Clients (Paginated)
GET {{baseUrl}}/clients?page=1&per_page=20
Authorization: Bearer {{accessToken}}

### Search Clients
GET {{baseUrl}}/clients?search=Benicio&page=1&per_page=10
Authorization: Bearer {{accessToken}}

### Filter Clients by Type
GET {{baseUrl}}/clients?person_type=company&client_type=client
Authorization: Bearer {{accessToken}}

### Sort Clients
GET {{baseUrl}}/clients?sort_by=fantasy_name&sort_order=asc&page=1&per_page=20
Authorization: Bearer {{accessToken}}

### Get Client Details
GET {{baseUrl}}/clients/{{clientId}}
Authorization: Bearer {{accessToken}}

### Create Company Client
POST {{baseUrl}}/clients
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
  "fantasy_name": "Tech Solutions Ltda",
  "company_name": "Tech Solutions Tecnologia Ltda",
  "document": "12.345.678/0001-90",
  "document_type": "cnpj",
  "person_type": "company",
  "client_type": "client",
  "email": "contato@techsolutions.com.br",
  "phone": "(11) 3456-7890",
  "mobile": "(11) 98765-4321",
  "website": "https://techsolutions.com.br",
  "revenue_range": "medium",
  "employee_count": 50,
  "notes": "Cliente desde 2024"
}

### Create Individual Client
POST {{baseUrl}}/clients
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
  "fantasy_name": "João Silva",
  "full_name": "João Carlos da Silva",
  "document": "123.456.789-00",
  "document_type": "cpf",
  "person_type": "individual",
  "client_type": "prospect",
  "email": "joao.silva@email.com",
  "phone": "(11) 3456-7890",
  "mobile": "(11) 98765-4321",
  "birth_date": "1985-05-15",
  "gender": "M",
  "marital_status": "married",
  "profession": "Empresário",
  "notes": "Prospect via indicação"
}

### Update Client
PUT {{baseUrl}}/clients/{{clientId}}
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
  "fantasy_name": "Tech Solutions Updated",
  "email": "novo@techsolutions.com.br",
  "client_type": "client",
  "notes": "Cliente VIP - Atualizado em 2024"
}

### Delete Client
DELETE {{baseUrl}}/clients/{{clientId}}
Authorization: Bearer {{accessToken}}

################################################################################
# USERS
################################################################################

### List All Users (Admin Only)
GET {{baseUrl}}/users?page=1&per_page=20
Authorization: Bearer {{accessToken}}

### Search Users
GET {{baseUrl}}/users?search=joão&page=1&per_page=10
Authorization: Bearer {{accessToken}}

### Filter by User Type
GET {{baseUrl}}/users?user_type=employee&is_active=true
Authorization: Bearer {{accessToken}}

### Sort Users
GET {{baseUrl}}/users?sort_by=created_at&sort_order=desc&page=1&per_page=20
Authorization: Bearer {{accessToken}}

### Get User Details
GET {{baseUrl}}/users/{{userId}}
Authorization: Bearer {{accessToken}}

### Create New User (Admin Only)
POST {{baseUrl}}/users
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
  "full_name": "Carlos Oliveira",
  "email": "carlos.oliveira@benicio.com.br",
  "username": "carlosoliveira",
  "password": "senha123",
  "user_type": "employee",
  "cpf": "987.654.321-00",
  "phone": "(11) 98765-4321",
  "birth_date": "1990-08-20",
  "hire_date": "2024-01-15",
  "department": "Jurídico",
  "position": "Advogado Júnior",
  "oab_number": "SP123456"
}

### Update User
PUT {{baseUrl}}/users/{{userId}}
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
  "full_name": "Carlos Oliveira Santos",
  "position": "Advogado Pleno",
  "department": "Jurídico - Cível",
  "phone": "(11) 91234-5678"
}

### Delete User (Soft Delete)
DELETE {{baseUrl}}/users/{{userId}}
Authorization: Bearer {{accessToken}}

### Get Current User Profile
GET {{baseUrl}}/me
Authorization: Bearer {{accessToken}}

### Get Current User Permissions
GET {{baseUrl}}/me/permissions
Authorization: Bearer {{accessToken}}

### Get Current User Roles
GET {{baseUrl}}/me/roles
Authorization: Bearer {{accessToken}}

################################################################################
# ROLES & PERMISSIONS
################################################################################

### List All Roles
GET {{baseUrl}}/admin/roles?page=1&per_page=10
Authorization: Bearer {{accessToken}}

### Get Role Details
GET {{baseUrl}}/admin/roles/{{roleId}}
Authorization: Bearer {{accessToken}}

### Attach Roles to User
PUT {{baseUrl}}/admin/roles/attach
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
  "user_id": {{userId}},
  "role_ids": [1, 2]
}

### List All Permissions
GET {{baseUrl}}/admin/permissions?page=1&per_page=10
Authorization: Bearer {{accessToken}}

### Create Permission
POST {{baseUrl}}/admin/permissions
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
  "resource": "folders",
  "action": "approve",
  "description": "Allow approving folders"
}

### Sync Role Permissions
PUT {{baseUrl}}/admin/roles/permissions/sync
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
  "role_id": {{roleId}},
  "permission_ids": [1, 2, 3, 4, 5]
}

### Attach Permissions to Role
PUT {{baseUrl}}/admin/roles/permissions/attach
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
  "role_id": {{roleId}},
  "permission_ids": [6, 7]
}

### Detach Permissions from Role
PUT {{baseUrl}}/admin/roles/permissions/detach
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
  "role_id": {{roleId}},
  "permission_ids": [1]
}

### Sync User Direct Permissions
PUT {{baseUrl}}/admin/users/permissions/sync
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
  "user_id": {{userId}},
  "permission_ids": [10, 11, 12]
}

### Get User's Direct Permissions
GET {{baseUrl}}/admin/users/{{userId}}/permissions
Authorization: Bearer {{accessToken}}

### Check User Permissions
POST {{baseUrl}}/admin/users/{{userId}}/permissions/check
Content-Type: {{contentType}}
Authorization: Bearer {{accessToken}}

{
  "permissions": ["folders.create", "folders.delete"],
  "require_all": false
}

################################################################################
# FILE UPLOADS
################################################################################

### Upload File
POST {{baseUrl}}/files/upload
Authorization: Bearer {{accessToken}}
Content-Type: multipart/form-data; boundary=----WebKitFormBoundary

------WebKitFormBoundary
Content-Disposition: form-data; name="file"; filename="document.pdf"
Content-Type: application/pdf

< ./document.pdf
------WebKitFormBoundary--

################################################################################
# HEALTH & SYSTEM
################################################################################

### Health Check
GET {{baseUrl}}/health

### API Version
GET http://localhost:3333/
